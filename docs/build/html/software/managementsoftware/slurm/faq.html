

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>FAQ &mdash; apolo-docs 0.1 documentation</title>
      <link rel="stylesheet" href="../../../_static/css/theme_overrides.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/sidebar.css" type="text/css" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=2709fde1"></script>
      <script src="../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="DMTCP" href="../tools/dmtcp/index.html" />
    <link rel="prev" title="Fairshare" href="fairshare.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

  
    <a href="../../../index.html" class="icon icon-home"> apolo-docs
  

  
    </a>

    

    
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../gettingstarted/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../supercomputers/index.html">Supercomputers</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Software</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../virtualization/index.html">Virtualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../programminglanguages/index.html">Programming Languages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../applications/index.html">Scientific Applications</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Management Software</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../index.html#lmod">Lmod</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../index.html#slurm">SLURM</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="index.html">SLURM</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#tools">Tools</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../provisioning/index.html">Provisioning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../monitoring/index.html">Monitoring</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../operatingsystems/index.html">Operating Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../scientific_libraries/index.html">Scientific Libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../accelerators/index.html">Accelerators</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../how-to-acknowledge.html">How to Acknowledge</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../report-a-bug.html">Report a Bug</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">apolo-docs</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Software</a></li>
          <li class="breadcrumb-item"><a href="../index.html">Management Software</a></li>
          <li class="breadcrumb-item"><a href="index.html">SLURM</a></li>
      <li class="breadcrumb-item active"><strong>FAQ</strong></li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/software/managementsoftware/slurm/faq.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="faq">
<span id="faq-slurm"></span><h1><strong>FAQ</strong><a class="headerlink" href="#faq" title="Link to this heading"></a></h1>
<nav class="contents local" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#what-should-be-the-cpu-load-on-my-node" id="id1">What should be the CPU Load on my node?</a></p></li>
<li><p><a class="reference internal" href="#in-which-cases-should-i-use-srun" id="id2">In which cases should I use <code class="docutils literal notranslate"><span class="pre">srun</span></code>?</a></p></li>
<li><p><a class="reference internal" href="#what-is-the-difference-between-n-n-and-c" id="id3">What is the difference between <code class="docutils literal notranslate"><span class="pre">N</span></code>, <code class="docutils literal notranslate"><span class="pre">n</span></code> and <code class="docutils literal notranslate"><span class="pre">c</span></code>?</a></p></li>
<li><p><a class="reference internal" href="#how-to-know-the-name-s-of-the-allocated-node-s-inside-my-job" id="id4">How to know the name(s) of the allocated node(s) inside my job ?</a></p></li>
</ul>
</nav>
<section id="what-should-be-the-cpu-load-on-my-node">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">What should be the CPU Load on my node?</a><a class="headerlink" href="#what-should-be-the-cpu-load-on-my-node" title="Link to this heading"></a></h2>
<p>The CPU Load is the measure of the amount of computational work that a compute
node has been performing. It is always a good idea to keep monitoring this
measure while you are computing in order to know how well your job is running
and if it agrees with the given parameters.</p>
<p>To do this, we are going to log in to the compute node (or nodes) where your
job is running on, then we are going to use <a class="reference external" href="https://hisham.hm/htop/">htop</a>. For example, <code class="docutils literal notranslate"><span class="pre">compute-0-0</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>ssh<span class="w"> </span>compute-0-0
$<span class="w"> </span>htop
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>You must have a running job on the compute node that you will log in to,
otherwise, you will not be able to do it. In case you have an active session
on a compute node and all of your jobs have finished their execution, Slurm is
going to kill all the user’s remaining processes on that node, including your current session.</p>
</div>
<p>On the <a class="reference external" href="https://hisham.hm/htop/">htop</a>. screen you will find all the running processes of that node.</p>
<p>The first thing you should check is if there’s <code class="docutils literal notranslate"><span class="pre">n</span></code> number of running process plus
one (the htop process).</p>
<p>Now, check the CPU load, htop display 3 different values: the Average of 1 minute,
5 minutes and 15 minutes. As a general rule, you should expect that the values
will be the number of running cores that you asked for in your sbatch script, in
most of the cases is the same number of tasks <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p>
<p>In this example, we ran a job in <a class="reference internal" href="../../../supercomputers/cronos/index.html#about-cronos"><span class="std std-ref">Cronos</span></a> with 16 processes.
Here, are the sbatch parameters.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">#SBATCH --ntasks=16</span>
<span class="c1">#SBATCH --time=30:00</span>
</pre></div>
</div>
<p>And here, is the screen of <a class="reference external" href="https://hisham.hm/htop/">htop</a> corresponding to the compute node that was running that job after
3 minutes.</p>
<img alt="../../../_images/htop2.png" src="../../../_images/htop2.png" />
<p>and here is the screen of <a class="reference external" href="https://hisham.hm/htop/">htop</a> on the same node after 20 minutes.</p>
<img alt="../../../_images/htop1.png" src="../../../_images/htop1.png" />
<p>As you can see, there is <strong>17</strong> running process (16 tasks + htop) and the load
average is close to <code class="docutils literal notranslate"><span class="pre">16.00</span></code>. All the cores (<code class="docutils literal notranslate"><span class="pre">16</span></code>) are in use.</p>
<p>Do not mind if you find that your <code class="docutils literal notranslate"><span class="pre">CPUs</span> <span class="pre">Load</span></code> is less than expected, it does
not necessarily mean that your job is not running in an optimal way. It could be
due that your application can not reach that CPU load, for example, it
frequently does <code class="docutils literal notranslate"><span class="pre">I/O</span></code> processing.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>However, if you have a considerably high <code class="docutils literal notranslate"><span class="pre">CPUs</span> <span class="pre">Load</span></code>
(e.g <code class="docutils literal notranslate"><span class="pre">40.00</span></code>, <code class="docutils literal notranslate"><span class="pre">50.00</span></code>, <code class="docutils literal notranslate"><span class="pre">300.00</span></code>), no matter the case, this is
<strong>not a good thing</strong> and it will affect substantially
the performance of your job. You are <strong>OVER LOADING</strong> the node.</p>
</div>
</section>
<section id="in-which-cases-should-i-use-srun">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">In which cases should I use <code class="docutils literal notranslate"><span class="pre">srun</span></code>?</a><a class="headerlink" href="#in-which-cases-should-i-use-srun" title="Link to this heading"></a></h2>
<p>There are three different ways in which jobs can be run by users in Slurm, using:
<code class="docutils literal notranslate"><span class="pre">srun</span></code>, <code class="docutils literal notranslate"><span class="pre">salloc</span></code> and <code class="docutils literal notranslate"><span class="pre">sbatch</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">srun</span></code> is used to create an interactive job, this means the job is going to
be linked with the current <code class="docutils literal notranslate"><span class="pre">tty</span></code> and <code class="docutils literal notranslate"><span class="pre">session</span></code> of the user. If you disconnect it,
you will lose control over the job, or it might be killed. In case the resources that
you specified are not available, you will need to wait, keeping the session alive.
The <code class="docutils literal notranslate"><span class="pre">std_out</span></code> and <code class="docutils literal notranslate"><span class="pre">std_err</span></code> will be written in your terminal.</p>
<p><code class="docutils literal notranslate"><span class="pre">salloc</span></code> is used to create jobs in allocated mode, the user is able to allocate
resources and, if available, interactively run jobs steps under that allocation
using a sub-shell created by Slurm. For further information see <code class="docutils literal notranslate"><span class="pre">man</span> <span class="pre">salloc</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">sbatch</span></code> is used to submit a job for later execution using a script. We have
documentation about in the <a class="reference internal" href="submit.html#submit"><span class="std std-ref">submit</span></a> section.</p>
<p>When you use <code class="docutils literal notranslate"><span class="pre">srun</span></code> inside a <code class="docutils literal notranslate"><span class="pre">sbatch</span></code> script, <code class="docutils literal notranslate"><span class="pre">srun</span></code> takes all the
parameters given to that script, once the needed resources of your job are available and
your job is ready to start running, <code class="docutils literal notranslate"><span class="pre">srun</span></code> will communicate to the Slurm compute node
daemons to launch the <code class="docutils literal notranslate"><span class="pre">ntasks</span></code> of your job as it was specified.</p>
<p>In conclusion, as a <strong>short answer</strong>, you <strong>need</strong> to use <code class="docutils literal notranslate"><span class="pre">srun</span></code> inside your sbatch scripts
when your job uses more than <strong>one</strong> <code class="docutils literal notranslate"><span class="pre">ntask</span></code> in order to allow Slurm to distribute these
tasks in the cluster. Otherwise, the number of <code class="docutils literal notranslate"><span class="pre">ntasks</span></code> won’t take effect and
the job will be serial. Thus, you should use <code class="docutils literal notranslate"><span class="pre">srun</span></code> inside your MPI and Array
jobs, in the <a class="reference internal" href="submit.html#submit"><span class="std std-ref">submit</span></a> section we have some examples of these cases.</p>
</section>
<section id="what-is-the-difference-between-n-n-and-c">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">What is the difference between <code class="docutils literal notranslate"><span class="pre">N</span></code>, <code class="docutils literal notranslate"><span class="pre">n</span></code> and <code class="docutils literal notranslate"><span class="pre">c</span></code>?</a><a class="headerlink" href="#what-is-the-difference-between-n-n-and-c" title="Link to this heading"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">N</span></code> refers to the number of <strong>Nodes</strong>. Nodes can compute one or more
<strong>tasks</strong> (<code class="docutils literal notranslate"><span class="pre">n</span></code>), ideally a <strong>node</strong> can compute up to its number of cores at the same time, also
depending on the specific application. Each task has one or more  <strong>threads</strong> (<code class="docutils literal notranslate"><span class="pre">c</span></code>).
We recommend to specify <code class="docutils literal notranslate"><span class="pre">n</span></code> tasks rather than <code class="docutils literal notranslate"><span class="pre">N</span></code> nodes, you should let
Slurm decides how many machines your job needs.</p>
<p><a class="reference external" href="https://www.backblaze.com/blog/whats-the-diff-programs-processes-and-threads/">Here</a> is a good explanation about the difference between Process and Threads.</p>
<img alt="../../../_images/Nnc.png" src="../../../_images/Nnc.png" />
</section>
<section id="how-to-know-the-name-s-of-the-allocated-node-s-inside-my-job">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">How to know the name(s) of the allocated node(s) inside my job ?</a><a class="headerlink" href="#how-to-know-the-name-s-of-the-allocated-node-s-inside-my-job" title="Link to this heading"></a></h2>
<p>The are cases where is useful to know which node(s) has been allocated to run my
job. In order to make your script dynamic, you can ask Slurm that information using:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># SBATCH PAMATERTS</span>

scontrol<span class="w"> </span>show<span class="w"> </span>hostname<span class="w"> </span>&gt;<span class="w"> </span>hostnames.out

<span class="c1"># job steps</span>
</pre></div>
</div>
<p>This example store the name of the allocated machines in the file <code class="docutils literal notranslate"><span class="pre">hostname.out</span></code>.
You can use it inside a <code class="docutils literal notranslate"><span class="pre">sbatch</span></code> script or as a command in a <code class="docutils literal notranslate"><span class="pre">salloc</span></code>
sub-shell.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="fairshare.html" class="btn btn-neutral float-left" title="Fairshare" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../tools/dmtcp/index.html" class="btn btn-neutral float-right" title="DMTCP" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Creative Commons Attribution-NonCommercial 4.0 International License.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>


<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Nagios Core - 4.4.1 &mdash; apolo-docs 0.1 documentation</title>
      <link rel="stylesheet" href="../../../../_static/css/theme_overrides.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/sidebar.css" type="text/css" />

  
      <script src="../../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../../_static/documentation_options.js?v=2709fde1"></script>
      <script src="../../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Installation" href="installation.html" />
    <link rel="prev" title="Nagios" href="../index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

  
    <a href="../../../../index.html" class="icon icon-home"> apolo-docs
  

  
    </a>

    

    
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../gettingstarted/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../supercomputers/index.html">Supercomputers</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../index.html">Software</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../virtualization/index.html">Virtualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../programminglanguages/index.html">Programming Languages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../applications/index.html">Scientific Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../managementsoftware/index.html">Management Software</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../provisioning/index.html">Provisioning</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../index.html">Monitoring</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../architecture/index.html">Monitoring Architecture</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../index.html">Nagios</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">Nagios Core - 4.4.1</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../sensu/index.html">Sensu</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../elk/index.html">ELK</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../grafana/index.html">Grafana</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../apolomonitoring/index.html">Apolo Monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../sensu_go/index.html">Sensu Go</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../operatingsystems/index.html">Operating Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../scientific_libraries/index.html">Scientific Libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../accelerators/index.html">Accelerators</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../how-to-acknowledge.html">How to Acknowledge</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../report-a-bug.html">Report a Bug</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">apolo-docs</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">Software</a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Monitoring</a></li>
          <li class="breadcrumb-item"><a href="../index.html">Nagios</a></li>
      <li class="breadcrumb-item active">Nagios Core - 4.4.1</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/software/monitoring/nagios/nagios-core-4.4.1/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="nagios-core-4-4-1">
<span id="nagios-core-4-4-1-index"></span><h1><a class="toc-backref" href="#id2" role="doc-backlink">Nagios Core - 4.4.1</a><a class="headerlink" href="#nagios-core-4-4-1" title="Link to this heading"></a></h1>
<nav class="contents" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#nagios-core-4-4-1" id="id2">Nagios Core - 4.4.1</a></p>
<ul>
<li><p><a class="reference internal" href="#basic-information" id="id3">Basic information</a></p></li>
<li><p><a class="reference internal" href="#directory-hierarchy" id="id4">Directory Hierarchy</a></p></li>
<li><p><a class="reference internal" href="#installation" id="id5">Installation</a></p></li>
<li><p><a class="reference internal" href="#mail-configuration" id="id6">Mail Configuration</a></p></li>
<li><p><a class="reference internal" href="#plugins" id="id7">Plugins</a></p></li>
<li><p><a class="reference internal" href="#usage" id="id8">Usage</a></p></li>
<li><p><a class="reference internal" href="#troubleshooting" id="id9">Troubleshooting</a></p>
<ul>
<li><p><a class="reference internal" href="#nagios-command-error" id="id10">Nagios Command Error</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#authors" id="id11">Authors</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="basic-information">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Basic information</a><a class="headerlink" href="#basic-information" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong>Deploy date:</strong> 14th August, 2018</p></li>
<li><p><strong>Official Website:</strong> <a class="reference external" href="https://www.nagios.org/about/">https://www.nagios.org/about/</a></p></li>
<li><p><strong>License:</strong> Nagios Open Software License, Nagios Software License, GNU GENERAL PUBLIC LICENSE</p></li>
</ul>
</section>
<section id="directory-hierarchy">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Directory Hierarchy</a><a class="headerlink" href="#directory-hierarchy" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong>bin:</strong> Nagios binaries.</p></li>
<li><p><strong>dell:</strong> Stores scripts, configuration files, images and
resources of Dell Plugin.</p></li>
<li><p><strong>etc:</strong> Stores Nagios configuration files.</p></li>
<li><p><strong>include</strong></p></li>
<li><p><strong>libexec:</strong> Contains most of the plugins installed.</p></li>
<li><p><strong>sbin:</strong> Nagios scripts</p></li>
<li><p><strong>share:</strong> Contains Web interface files.</p></li>
<li><p><strong>var</strong></p></li>
</ul>
</section>
<section id="installation">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Installation</a><a class="headerlink" href="#installation" title="Link to this heading"></a></h2>
<p>This entry covers the entire process performed for the installation and
configuration of Nagios Core in Centos 7. This process of installation and configuration
is automated using Ansible.</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="installation.html#tested-on-requirements"><strong>Tested on (Requirements)</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#directory-structure">Directory Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#ansible-structure">Ansible Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#initial-configuration">Initial Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="installation.html#dell-repos-yml">dell-repos.yml</a></li>
<li class="toctree-l3"><a class="reference internal" href="installation.html#packages-yml">packages.yml</a></li>
<li class="toctree-l3"><a class="reference internal" href="installation.html#nagios-users-yml">nagios-users.yml</a></li>
<li class="toctree-l3"><a class="reference internal" href="installation.html#apache-config-yml">apache-config.yml</a></li>
<li class="toctree-l3"><a class="reference internal" href="installation.html#firewall-config-yml">firewall-config.yml</a></li>
<li class="toctree-l3"><a class="reference internal" href="installation.html#ipmi-config-yml">ipmi-config.yml</a></li>
<li class="toctree-l3"><a class="reference internal" href="installation.html#mail-config-yml">mail-config.yml</a></li>
<li class="toctree-l3"><a class="reference internal" href="installation.html#snmp-config-yml">snmp-config.yml</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#installing-nagios-core">Installing Nagios Core</a><ul>
<li class="toctree-l3"><a class="reference internal" href="installation.html#nagios-install-yml-and-nagios-installed-yml">nagios-install.yml and nagios-installed.yml</a></li>
<li class="toctree-l3"><a class="reference internal" href="installation.html#nagios-config-yml">nagios-config.yml</a></li>
<li class="toctree-l3"><a class="reference internal" href="installation.html#nagios-post-install-yml">nagios-post-install.yml</a></li>
<li class="toctree-l3"><a class="reference internal" href="installation.html#selinux-config-yml">selinux-config.yml</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#installing-nagios-plugins">Installing Nagios Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#final-check">Final Check</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#references">References</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#authors">Authors</a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="mail-configuration">
<span id="id1"></span><h2><a class="toc-backref" href="#id6" role="doc-backlink">Mail Configuration</a><a class="headerlink" href="#mail-configuration" title="Link to this heading"></a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This configuration is automatically set up in the step of synchronization in the taskfile <a class="reference internal" href="installation.html#nagios-config-yml"><span class="std std-ref">nagios-config.yml</span></a> if the base configuration is included in the synchronization list.</p>
</div>
<p>The commands <code class="code highlight bash docutils literal highlight-bash">notify-host-by-email</code> and <code class="code highlight bash docutils literal highlight-bash">notify-service-by-email</code> were modified adding the flag -A:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>/usr/bin/printf<span class="w"> </span><span class="s2">&quot;MAIL_BODY&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>/bin/mail<span class="w"> </span>-A<span class="w"> </span>nagios<span class="w"> </span>-s<span class="w"> </span><span class="s2">&quot;SUBJECT&quot;</span><span class="w"> </span><span class="nv">$CONTACTEMAIL</span>$
</pre></div>
</div>
<p>In order to uncouple the mail definition from the command line, the flag <code class="code highlight bash docutils literal highlight-bash">-A<span class="w"> </span>nagios</code> was added. With this option, <strong>mail</strong> will use the configuration defined in the account nagios, in the file
<code class="code highlight bash docutils literal highlight-bash">/etc/mail.rc</code></p>
</div></blockquote>
<p>Example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>account<span class="w"> </span>nagios<span class="w"> </span><span class="o">{</span>
<span class="nb">set</span><span class="w"> </span><span class="nv">smtp</span><span class="o">=</span>smtp.server.hostname:port
<span class="nb">set</span><span class="w"> </span><span class="nv">sender</span><span class="o">=</span>nagios@mail
<span class="nb">set</span><span class="w"> </span><span class="nv">from</span><span class="o">=</span><span class="s2">&quot;nagios@mail&quot;</span>
<span class="nb">set</span><span class="w"> </span>ssl-verify<span class="o">=</span>ignore
<span class="o">}</span>
</pre></div>
</div>
</section>
<section id="plugins">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">Plugins</a><a class="headerlink" href="#plugins" title="Link to this heading"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="plugins/nagios-plugins.html">Nagios-plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="plugins/ipmi-sensors.html">IPMI Sensors - Nagios Plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="plugins/dell-openmanage.html">Dell OpenManage - Nagios Plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="plugins/ilo-rest.html">iLO AgentLess Management - Nagios Plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="plugins/pnp4nagios.html">PNP4Nagios</a></li>
</ul>
</div>
</section>
<section id="usage">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">Usage</a><a class="headerlink" href="#usage" title="Link to this heading"></a></h2>
<p>Before executing the role it’s important to verify the value of the variables in the file
<code class="code highlight bash docutils literal highlight-bash">roles/healthckeck/vars/main.yml</code>. These variables were created in order to uncouple from the code things like IPs, URLs and passwords. In the case of passwords, we used <strong>Ansible Vault</strong> for ciphering them.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ansible-vault<span class="w"> </span>playbooks/healthcheck.yml<span class="w"> </span>--ask-vault-pass
</pre></div>
</div>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>This Ansible role was created thinking in the Ansible Philosophy: <strong>The tool should be used to represent the state of the server, not as a procedural language but as a declarative one.</strong></p>
<p>This role was developed to be run multiple times in the same server: If the real state doesn’t matches with the role state, the server is modified in order to match both states. If the server has well configured and well installed Nagios and it’s plugins, running the playbook will say <strong>Ok</strong> in most of the tasks, so it  won’t break any configuration.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The flag <code class="code highlight bash docutils literal highlight-bash">--ask-vault-pass</code> is used because this role uses ansible-vault for encrypting private data like passwords.</p>
</div>
</section>
<section id="troubleshooting">
<h2><a class="toc-backref" href="#id9" role="doc-backlink">Troubleshooting</a><a class="headerlink" href="#troubleshooting" title="Link to this heading"></a></h2>
<section id="nagios-command-error">
<span id="nagios-cmd-error"></span><h3><a class="toc-backref" href="#id10" role="doc-backlink">Nagios Command Error</a><a class="headerlink" href="#nagios-command-error" title="Link to this heading"></a></h3>
<img alt="Nagios Command Error" src="../../../../_images/nagios-cmd-error.png" />
<p>This error occurs when the user generates a modification in the Nagios Command file executing
different actions with the Nagios Web Interface <em>(eg. re-schedule checks)</em>. This error is corrected
with the execution of the task <a class="reference internal" href="installation.html#selinux-config-yml"><span class="std std-ref">selinux-config.yml</span></a>.</p>
<p>By default, the Apache daemon cannot read/write the files under <code class="code highlight bash docutils literal highlight-bash">/usr/local/nagios/var/rw</code> or
execute from <code class="code highlight bash docutils literal highlight-bash">/usr/local/nagios/sbin</code> because these directories doesn’t belongs to
the <code class="code highlight bash docutils literal highlight-bash">httpd_sys_rw_content_t</code> SELinux context and <code class="code highlight bash docutils literal highlight-bash">httpd_sys_script_exec_t</code> context
respectively. This is what originates the problem.</p>
</section>
</section>
<section id="authors">
<h2><a class="toc-backref" href="#id11" role="doc-backlink">Authors</a><a class="headerlink" href="#authors" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Andrés Felipe Zapata Palacio &lt;<a class="reference external" href="mailto:azapat47&#37;&#52;&#48;eafit&#46;edu&#46;co">azapat47<span>&#64;</span>eafit<span>&#46;</span>edu<span>&#46;</span>co</a>&gt;</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../index.html" class="btn btn-neutral float-left" title="Nagios" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="installation.html" class="btn btn-neutral float-right" title="Installation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Creative Commons Attribution-NonCommercial 4.0 International License.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>